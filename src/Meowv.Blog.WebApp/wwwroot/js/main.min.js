function mobileBtn(){var n=document.getElementsByClassName("menu-toggle")[0],t=document.getElementById("mobile-menu");n.classList.contains("active")?(n.classList.remove("active"),t.classList.remove("active")):(n.classList.add("active"),t.classList.add("active"))}function process_page(n){var s,l,a,o,f,h,c,t,e,u,r;const i={home:"/",posts:"/posts",post:"/post/",categories:"/categories",category:"/category/",tags:"/tags",tag:"/tag/",apps:"/apps",tucao:"/tucao",sign:"/sign",hot:"/hot",soul:"/soul",imgs:["/girl","/cat","/cat/","/bing"],analysis:"/analysis",friendlinks:"/friendlinks",wallpaper:"/wallpaper"};if(n==i.home)document.querySelector(".weixin").addEventListener("click",function(){document.querySelector(".qrcode").classList.contains("hidden")?document.querySelector(".qrcode").classList.remove("hidden"):document.querySelector(".qrcode").classList.add("hidden")});else if(n.indexOf(i.apps)==0)document.querySelector("#change_song_list").addEventListener("click",function(){load_audio()});else if(i.imgs.indexOf(n)>=0)window.onload=()=>document.querySelector(".loader").remove(),n==i.imgs[0]&&document.querySelector(".soul-btn").addEventListener("click",()=>document.querySelector(".girl-img img").src=document.querySelector(".girl-img img").src.split("?")[0]+"?t="+(new Date).getTime());else if(n.indexOf(i.hot)==0){axios.get(`${api_domain}/common/hot_news_source`).then(function(t){var f=template("top_tabs_tmpl",{result:t.data.result}),u,r,i;for(document.querySelector(".top-tab ul").innerHTML=f,document.querySelector(".top-tab ul li a").classList.add("archive"),u=document.querySelector(".top-tab ul li a").attributes["data-id"].value,n(u),r=document.querySelectorAll(".top-tab ul li a"),i=0;i<r.length;i++)r[i].onclick=function(){document.querySelector(".loader").style.cssText="display:block";document.querySelector(".top-tab ul li a.archive").classList.remove("archive");this.classList.add("archive");var t=this.attributes["data-id"].value;n(t)}});function n(n){axios.get(`${api_domain}/common/hot_news?sourceId=${n}`).then(function(n){var t=template("top_content_tmpl",n.data);document.querySelector(".top-content ul").innerHTML=t;document.querySelector(".loader").style.cssText="display:none"})}}else if(n.indexOf(i.sign)==0){s="https://static.meowv.com/signature/";axios.all([n(),t()]).then(axios.spread(function(n,t){var r="",u,f,i;for(n.data.result.forEach(n=>{r+=n.value==901?`<option selected="selected" value="${n.value}">${n.description}</option>`:`<option value="${n.value}">${n.description}</option>`}),u="",t.data.result.forEach(n=>{u+=`<a href="javascript:;" data-url="${n.url}">${n.name}</a>`}),document.querySelector("#type").innerHTML=r,document.querySelector(".tag-cloud-tags-extend").innerHTML=u,document.querySelector(".signature-box").style.cssText="display:block",document.querySelector(".post-wrap").style.cssText="display:block",document.querySelector(".loader").remove(),f=document.querySelectorAll(".tag-cloud-tags-extend a"),i=0;i<f.length;i++)f[i].onclick=function(){var n=this.attributes["data-url"].value;document.querySelector(".signature-img img").src=s+n}}));function n(){return axios.get(`${api_domain}/signature/type`)}function t(){return axios.get(`${api_domain}/signature/logs`)}a=new TencentCaptcha("2049355346",function(n){n.ret===0&&axios.get(`${api_domain}/tca/captcha?ticket=${n.ticket}&randstr=${n.randstr}`).then(function(n){n.data.success&&axios.get(`${api_domain}/signature?name=${r}&id=${l}`).then(function(n){document.querySelector(".signature-img img").src=s+n.data.result})})});document.querySelector("#btn_do").addEventListener("click",function(){if(l=document.querySelector("#type").value,r=document.querySelector("#name").value.trim(),r.length>4||r.length==0)return!1;a.show()})}else if(n.indexOf(i.soul)==0){n();function n(){axios.get(`${api_domain}/soul`).then(function(n){n.data.success&&(document.querySelector(".soul h1").innerText=n.data.result)})}document.querySelector(".soul-btn").addEventListener("click",()=>n())}else if(n.indexOf(i.tucao)==0){window.onresize=()=>n();window.onload=()=>n();function n(){document.getElementById("tucao").height=document.documentElement.clientHeight-200}}else if(n.indexOf(i.analysis)==0){o=new Date;f=o.getFullYear()+"-"+n(o.getMonth()+1)+"-"+n(o.getDate()-1);function n(n){return n<10?"0"+n:n}document.querySelectorAll(".mta-date").forEach(n=>n.innerText=f);axios.get(`${api_domain}/mta/ctr_core_data?start_date=${f}&end_date=${f}&idx=pv,uv,vv,iv`).then(function(n){if(n.data.info="success"){var i=f.replace(/-/g,""),t=n.data.data[i];document.querySelector("#pv strong").innerText=t.pv;document.querySelector("#uv strong").innerText=t.uv;document.querySelector("#vv strong").innerText=t.vv;document.querySelector("#iv strong").innerText=t.iv;document.querySelector(".mta-a ul").style.cssText="display:block";document.querySelector(".loader").remove()}})}else if(n.indexOf(i.friendlinks)==0)axios.get(`${api_domain}/blog/friendlinks`).then(function(n){if(n.data.success){var t=template("friendlinks_tmpl",n.data);document.querySelector(".categories-card").innerHTML=t;document.querySelector(".loader").remove()}});else if(n.indexOf(i.posts)==0)h=location.pathname.replace(/posts|page|\//gi,"")||1,c=15,axios.get(`${api_domain}/blog/post/query?page=${h}&limit=${c}`).then(function(n){var r,u,f,i,t;if(n.data){if(!n.data.result)return document.querySelector(".post-wrap.archive").innerHTML=`<h2 class="post-title">找了找不到了~~~</h2>`,document.querySelector(".loader").remove(),!1;for(r={result:n.data.result},u=template("posts_tmpl",r),document.querySelector(".post-wrap.archive").insertAdjacentHTML("afterbegin",u),f=Math.ceil(n.data.total/c),i="",t=1;t<=f;t++)i+=h==t?`<span class="page-number current">${t}</span>`:`<a class="page-number" href="/posts/page/${t}/">${t}</a>`;document.querySelector(".pagination").innerHTML=i;document.querySelector(".loader").remove();document.getElementById("posts_tmpl").remove()}});else if(n.indexOf(i.wallpaper)==0){t={type:0,page:1,keywords:""};e={};location.search.replace(/([^?&=]+)=([^&]+)/g,(n,t,i)=>e[t]=i);t.type=e.t||0;t.page=e.p||1;t.keywords=e.k||"";u();n(t.type,t.page,t.keywords);r();function u(){axios.get(`${api_domain}/wallpaper/types`).then(function(n){var i=n.data.result,r;t.type==0&&i.splice(0,0,{key:"All",value:0,description:"全部"});r=template("wallpaper_nav_tmpl",{result:i});document.querySelector(".wallpaper-nav").innerHTML=r;document.querySelector(".wallpaper-nav a").classList.add("wallpaper-active")}).then(function(){for(var f=document.querySelectorAll(".wallpaper-nav a"),u=0;u<f.length;u++)f[u].attributes["data-type"].value==t.type&&i(f[u]),f[u].onclick=function(){document.querySelector(".loader").style.cssText="display:block";t.type=this.attributes["data-type"].value;t.page=1;t.keywords="";i(this);n(t.type,t.page,t.keywords);r()}})}function n(n,t,i){axios.get(`${api_domain}/wallpaper?type=${n}&page=${t}&keywords=${i}`).then(function(r){var e=template("wallpaper_tmpl",r.data),f,u;document.querySelector(".wallpapers").innerHTML=e;f=Math.ceil(r.data.total/30);u="";t=Number(t);u+=t==1?`<span class="page-number">Previous</span><a class="page-number" href="/wallpaper?t=${n}&k=${i}&p=${t+1}">Next</a>`:t>=f?`<a class="page-number" href="/wallpaper?t=${n}&k=${i}&p=${t-1}">Previous</a><span class="page-number">Next</span>`:`<a class="page-number" href="/wallpaper?t=${n}&k=${i}&p=${t-1}">Previous</a><a class="page-number" href="/wallpaper?t=${n}&k=${i}&p=${t+1} ">Next</a>`;document.querySelector(".pagination").innerHTML=u;document.querySelector(".loader").style.cssText="display:none"}).then(function(){f()})}function i(n){document.querySelectorAll(".wallpaper-nav a").forEach(n=>{n.classList.remove("wallpaper-active")});n.classList.add("wallpaper-active")}function r(){history.pushState(null,null,location.href.split("?")[0]+"?t="+t.type+"&k="+t.keywords+"&p="+t.page)}function f(){for(var t=document.querySelectorAll(".wallpaper img"),n=0;n<t.length;n++)t[n].onclick=function(){fetch(this.src.replace("middle","max")).then(n=>n.blob().then(n=>{window.open(window.URL.createObjectURL(n),"_blank")}))}}document.body.oncontextmenu=function(){self.event.returnValue=!1};document.onkeydown=function(){if(event.ctrlKey&&window.event.keyCode==85||event.ctrlKey&&event.shiftKey&&window.event.keyCode==73)return!1;window.event&&window.event.keyCode==123&&(event.keyCode=0,event.returnValue=!1)}}else if(n.indexOf(i.post)==0)u=location.pathname.replace("/post",""),u=u.substring(u.length-1)=="/"?u:u+"/",axios.get(`${api_domain}/blog/post?url=${u}`).then(function(n){if(n.data.success){document.title=document.title.substring(0,2)+n.data.result.title+" - "+document.title.substring(2);var t=template("detail_tmpl",n.data);document.querySelector(".post-wrap").innerHTML=t}else document.querySelector(".post-wrap").innerHTML=`<h2 class="post-title">${n.data.message}</h2>`;document.querySelector(".loader").remove();editormd.markdownToHTML("content")});else if(n.indexOf(i.tags)==0)axios.get(`${api_domain}/blog/tags`).then(function(n){if(n.data.success){var t=template("tags_tmpl",n.data);document.querySelector(".tag-cloud-tags").innerHTML=t;document.querySelector(".loader").remove()}});else if(n.indexOf(i.tag)==0){r=location.pathname.replace(/tag|\//gi,"");axios.all([n(r),t(r)]).then(axios.spread(function(n,t){var i;n.data.success?(document.title=document.title.substring(0,2)+n.data.result+" - "+document.title.substring(2),i=template("tagName_tmpl",n.data),document.querySelector(".post-title").innerHTML=i):document.querySelector(".post-title").innerText=n.data.msg;t.data.success&&(i=template("tag_post_tmpl",t.data),document.querySelector(".post-wrap.archive").innerHTML=i,document.querySelector(".loader").remove())}));function n(n){return axios.get(`${api_domain}/blog/tag?name=${n}`)}function t(n){return axios.get(`${api_domain}/blog/post/query_by_tag?name=${n}`)}}else if(n.indexOf(i.categories)==0)axios.get(`${api_domain}/blog/categories`).then(function(n){if(n.data.success){var t=template("categories_tmpl",n.data);document.querySelector(".categories-card").innerHTML=t;document.querySelector(".loader").remove()}});else if(n.indexOf(i.category)==0){r=location.pathname.replace(/category|\//gi,"");axios.all([n(r),t(r)]).then(axios.spread(function(n,t){var i;n.data.success?(document.title=document.title.substring(0,2)+n.data.result+" - "+document.title.substring(2),i=template("categoryName_tmpl",n.data),document.querySelector(".post-title").innerHTML=i):document.querySelector(".post-title").innerText=n.data.msg;t.data.success&&(i=template("category_post_tmpl",t.data),document.querySelector(".post-wrap.archive").innerHTML=i,document.querySelector(".loader").remove())}));function n(n){return axios.get(`${api_domain}/blog/category?name=${n}`)}function t(n){return axios.get(`${api_domain}/blog/post/query_by_category?name=${n}`)}}}function load_audio(){window.localStorage.removeItem("audio");window.localStorage.removeItem("currentPlayIndex");window.localStorage.removeItem("currentPlayTime");var n=new XMLHttpRequest;n.onreadystatechange=function(){var t,i,r;n.readyState==4&&n.status==200&&(t=JSON.parse(n.responseText),t.success&&(i=t.result,window.localStorage.setItem("audio",JSON.stringify(i)),window.localStorage.setItem("audioExpireDate",(new Date).getTime()+36e5),r=[],i.forEach(n=>{r.push({name:n.title,artist:n.artist,cover:n.cover,url:n.url,lrc:n.lrc})}),load_player(r)))};n.open("get",api_domain+"/fm/songs",!0);n.setRequestHeader("Content-type","application/json");n.send()}function load_player(n){player=new APlayer({container:document.getElementById("aplayer"),fixed:!0,autoplay:!1,lrcType:3,audio:n});player.lrc.hide()}function showNotification(n,t,i){"Notification"in window?Notification.permission==="granted"?notify(n,t,i):Notification.permission!=="denied"&&Notification.requestPermission(function(r){"permission"in Notification||(Notification.permission=r);r==="granted"&&notify(n,t,i)}):console.log("This browser does not support desktop notification")}var _mtac,notify,connection;api_domain="https://api.meowv.com";_mtac={performanceMonitor:1,senseQuery:1},function(){var n=document.createElement("script"),i;n.src="//pingjs.qq.com/h5/stats.js?v2.0.4";n.setAttribute("name","MTAH5");n.setAttribute("sid","500692160");n.setAttribute("cid","500692161");i=document.getElementsByTagName("script")[0];i.parentNode.insertBefore(n,i);var u=!!(window.attachEvent&&!window.opera),f=/webkit\/(\d+)/i.test(navigator.userAgent)&&RegExp.$1<525,r=[],e=function(){for(var n=0;n<r.length;n++)r[n]()},t=document;t.ready=function(n){if(!u&&!f&&t.addEventListener)return t.addEventListener("DOMContentLoaded",n,!1);if(!(r.push(n)>1))if(u)(function(){try{t.documentElement.doScroll("left");e()}catch(n){setTimeout(arguments.callee,0)}})();else if(f)var i=setInterval(function(){/^(loaded|complete)$/.test(t.readyState)&&(clearInterval(i),e())},0)}}();document.ready(function(){var t=window._Blog||{},n;const r=window.localStorage.getItem("theme"),i=r==="dark";n="black";i?(document.getElementById("switch_default").checked=!0,document.getElementById("mobile-toggle-theme").innerText=" · Dark",n="white"):(document.getElementById("switch_default").checked=!1,document.getElementById("mobile-toggle-theme").innerText=" · Dark",n="black");L2Dwidget.init({model:{jsonPath:`https://static.meowv.com/live2d/tororo/assets/tororo.model_${n}.json`},display:{superSample:1.5,width:100,height:100,position:"right",hOffset:5,vOffset:5},mobile:{show:!0,scale:1,motion:!0},react:{opacityDefault:.5,opacityOnHover:.2}});t.toggleTheme=function(){i?(document.getElementsByTagName("body")[0].classList.add("dark-theme"),document.getElementById("mobile-toggle-theme").innerText=" · Dark"):(document.getElementsByTagName("body")[0].classList.remove("dark-theme"),document.getElementById("mobile-toggle-theme").innerText=" · Light");document.getElementsByClassName("toggleBtn")[0].addEventListener("click",()=>{document.getElementsByTagName("body")[0].classList.contains("dark-theme")?document.getElementsByTagName("body")[0].classList.remove("dark-theme"):document.getElementsByTagName("body")[0].classList.add("dark-theme"),window.localStorage.setItem("theme",document.body.classList.contains("dark-theme")?"dark":"light")});document.getElementById("mobile-toggle-theme").addEventListener("click",()=>{document.getElementsByTagName("body")[0].classList.contains("dark-theme")?(document.getElementsByTagName("body")[0].classList.remove("dark-theme"),document.getElementById("mobile-toggle-theme").innerText=" · Light"):(document.getElementsByTagName("body")[0].classList.add("dark-theme"),document.getElementById("mobile-toggle-theme").innerText=" · Dark"),window.localStorage.setItem("theme",document.body.classList.contains("dark-theme")?"dark":"light")})};t.toggleTheme()});const pathname=location.pathname;process_page(pathname);player=null;const currentAudio=window.localStorage.getItem("audio"),audioExpireDate=window.localStorage.getItem("audioExpireDate");currentAudio?(new Date).getTime()>audioExpireDate?load_audio():(load_player(JSON.parse(currentAudio)),player.list.switch(window.localStorage.getItem("currentPlayIndex")),setTimeout(function(){player.seek(window.localStorage.getItem("currentPlayTime"))},500)):load_audio();setInterval(function(){player.audio.paused||(window.localStorage.setItem("currentPlayIndex",player.list.index),window.localStorage.setItem("currentPlayTime",player.audio.currentTime))},1e3);notify=function(n,t,i){var r=new Notification(n,{body:t,icon:"https://static.meowv.com/favicon.ico",data:i});r.onclick=function(){window.open(r.data)};setTimeout(function(){r.close()},5e3)};connection=(new signalR.HubConnectionBuilder).withUrl("/connection").build();connection.on("ReceiveNotification",function(n,t,i){showNotification(n,t,i)});connection.start().catch(function(n){return console.error(n.toString())});console.log("\n %c 执行 load_audio() 换一批歌单 %c http://meowv.com \n","color: #fadfa3; background: #030307; padding:5px 0;","background: #fadfa3; padding:5px 0;");