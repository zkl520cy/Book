function min(n){for(var r,i=0,u=n[i],t=1,f=n.length;t<f;t++)r=n[t],r<u&&(i=t,u=r);return i}function show(n,t){var r=[],f=document.body.offsetWidth,e=parseInt(f/t),o=e==0?1:e,c=f>=t?f-o*t:0,i,s,u,h;for(document.querySelector(".container").style.left=parseInt(c/2)-margin/2+"px",i=0,s=n.length;i<s;i++)i<o?(r[i]=n[i].offsetHeight+margin,n[i].style.top=0,n[i].style.left=i*t+margin+"px"):(u=min(r),h=n[i].offsetHeight+margin,n[i].style.top=r[u]+"px",n[i].style.left=u*t+margin+"px",r[u]+=h)}function loadImageAsync(n){return new Promise(function(t,i){var r=new Image;r.src=n;r.onload=function(){var i={url:n,width:r.width,height:r.height};t(i)};r.onerror=function(){i(new Error("Could not load image at "+n))}})}var margin=8;axios.get("https://api.meowv.com/gallery").then(function(n){var r,t,i;n.data.success&&(r=template("gallery_tmpl",n.data),document.querySelector(".container").innerHTML=r,t=document.querySelectorAll(".albums"),i=t[0].offsetWidth+margin,show(t,i),window.onload=function(){show(t,i)},window.onresize=function(){show(t,i)},t.forEach(n=>{n.onclick=function(){const t=[];var i=this.attributes["data-id"].value,n="";this.attributes["data-isPublic"].value=="false"&&(n=prompt("请输入相册访问口令",""));n!=null&&n!=""&&axios.get(`https://api.meowv.com/gallery/images?id=${i}&password=${n}`).then(function(n){if(n.data.success){n.data.result.forEach(n=>{t.push({src:n.imgUrl,w:n.width,h:n.height}),loadImageAsync(n.imgUrl)});var i=new PhotoSwipe(document.querySelector(".pswp"),PhotoSwipeUI_Default,t,{history:!1,focus:!1,showAnimationDuration:0,hideAnimationDuration:0});i.init()}else alert(n.data.msg)})}}))});